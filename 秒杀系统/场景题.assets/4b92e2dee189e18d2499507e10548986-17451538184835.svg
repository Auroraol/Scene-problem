<svg id="svg" width="1525" xmlns="http://www.w3.org/2000/svg" height="2327" viewBox="-50 -10 1525 2327"><rect x="45" y="1677" fill="rgb(50, 0, 50, .1)" width="850" height="508" class="rect"></rect><rect x="455" y="1418" fill="rgb(125, 125, 125, .1)" width="970" height="249" class="rect"></rect><rect x="445" y="699" fill="rgb(125, 125, 0, .1)" width="745" height="709" class="rect"></rect><rect x="445" y="274" fill="rgb(255, 0, 0, .1)" width="460" height="415" class="rect"></rect><style>#svg{font-family:"trebuchet ms",verdana,arial;font-size:16px;fill:#333;}#svg .error-icon{fill:#552222;}#svg .error-text{fill:#552222;stroke:#552222;}#svg .edge-thickness-normal{stroke-width:2px;}#svg .edge-thickness-thick{stroke-width:3.5px;}#svg .edge-pattern-solid{stroke-dasharray:0;}#svg .edge-pattern-dashed{stroke-dasharray:3;}#svg .edge-pattern-dotted{stroke-dasharray:2;}#svg .marker{fill:#333333;}#svg .marker.cross{stroke:#333333;}#svg svg{font-family:"trebuchet ms",verdana,arial;font-size:16px;}#svg .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#svg text.actor &gt; tspan{fill:black;stroke:none;}#svg .actor-line{stroke:grey;}#svg .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#svg .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#svg #arrowhead path{fill:#333;stroke:#333;}#svg .sequenceNumber{fill:white;}#svg #sequencenumber{fill:#333;}#svg #crosshead path{fill:#333;stroke:#333;}#svg .messageText{fill:#333;stroke:#333;}#svg .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#svg .labelText,#svg .labelText &gt; tspan{fill:black;stroke:none;}#svg .loopText,#svg .loopText &gt; tspan{fill:black;stroke:none;}#svg .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%);}#svg .note{stroke:#aaaa33;fill:#fff5ad;}#svg .noteText,#svg .noteText &gt; tspan{fill:black;stroke:none;}#svg .activation0{fill:#f4f4f4;stroke:#666;}#svg .activation1{fill:#f4f4f4;stroke:#666;}#svg .activation2{fill:#f4f4f4;stroke:#666;}#svg .today{display:none;}#svg .label foreignObject{overflow:visible;}#svg:root{--mermaid-font-family:"trebuchet ms",verdana,arial;}#svg sequence{fill:apa;}</style><g></g><g><line id="actor0" x1="75" y1="5" x2="75" y2="2316" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="75" dy="0">用户</tspan></text></g><g><line id="actor1" x1="275" y1="5" x2="275" y2="2316" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="275" dy="0">限流器</tspan></text></g><g><line id="actor2" x1="475" y1="5" x2="475" y2="2316" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="475" dy="0">队列(MQ)</tspan></text></g><g><line id="actor3" x1="675" y1="5" x2="675" y2="2316" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="600" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="675" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="675" dy="0">秒杀IC</tspan></text></g><g><line id="actor4" x1="875" y1="5" x2="875" y2="2316" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="800" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="875" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="875" dy="0">缓存</tspan></text></g><g><line id="actor5" x1="1075" y1="5" x2="1075" y2="2316" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1000" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1075" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="1075" dy="0">订单系统</tspan></text></g><g><line id="actor6" x1="1319" y1="5" x2="1319" y2="2316" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1244" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1319" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="1319" dy="0">库存系统</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><text x="175" y="80" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">下单</text><line x1="75" y1="113" x2="275" y2="113" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="75" y="117" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">1</text><text x="175" y="173" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">结束</text><line x1="275" y1="206" x2="75" y2="206" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="275" y="210" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">2</text><g><line x1="65" y1="123" x2="285" y2="123" class="loopLine"></line><line x1="285" y1="123" x2="285" y2="216" class="loopLine"></line><line x1="65" y1="216" x2="285" y2="216" class="loopLine"></line><line x1="65" y1="123" x2="65" y2="216" class="loopLine"></line><polygon points="65,123 115,123 115,136 106.6,143 65,143" class="labelBox"></polygon><text x="90" y="136" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">opt</text><text x="200" y="141" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="200">[触发限流]</tspan></text></g><text x="375" y="231" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">请求排队</text><line x1="275" y1="264" x2="475" y2="264" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#crosshead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="275" y="268" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">3</text><text x="575" y="344" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">下单请求</text><line x1="475" y1="377" x2="675" y2="377" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="475" y="381" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">4</text><text x="775" y="392" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">库存查验及扣减</text><line x1="675" y1="425" x2="875" y2="425" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="675" y="429" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">5</text><text x="775" y="440" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">操作结果</text><line x1="875" y1="473" x2="675" y2="473" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="875" y="477" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">6</text><text x="775" y="533" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">下单失败</text><line x1="675" y1="566" x2="875" y2="566" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="675" y="570" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">7</text><text x="575" y="626" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">创建订单</text><line x1="675" y1="659" x2="475" y2="659" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#crosshead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="675" y="663" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">8</text><g><line x1="465" y1="483" x2="885" y2="483" class="loopLine"></line><line x1="885" y1="483" x2="885" y2="669" class="loopLine"></line><line x1="465" y1="669" x2="885" y2="669" class="loopLine"></line><line x1="465" y1="483" x2="465" y2="669" class="loopLine"></line><line x1="465" y1="581" x2="885" y2="581" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="465,483 515,483 515,496 506.6,503 465,503" class="labelBox"></polygon><text x="490" y="496" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">alt</text><text x="700" y="501" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="700">[扣减不成功]</tspan></text><text x="675" y="599" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">[扣减成功]</text></g><g><line x1="455" y1="294" x2="895" y2="294" class="loopLine"></line><line x1="895" y1="294" x2="895" y2="679" class="loopLine"></line><line x1="455" y1="679" x2="895" y2="679" class="loopLine"></line><line x1="455" y1="294" x2="455" y2="679" class="loopLine"></line><polygon points="455,294 505,294 505,307 496.6,314 455,314" class="labelBox"></polygon><text x="480" y="307" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">opt</text><text x="700" y="312" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="700">[请求处理]</tspan></text></g><text x="775" y="814" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">创建订单消息</text><line x1="475" y1="847" x2="1075" y2="847" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="475" y="851" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">9</text><text x="775" y="862" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">扣减库存消息(事务消息)</text><line x1="1075" y1="895" x2="475" y2="895" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#crosshead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="1075" y="899" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">10</text><text x="1075" y="910" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">创建订单(用户不可见)</text><path d="M 1075,943 C 1135,933 1135,973 1075,963" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></path><text x="1075" y="947" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">11</text><text x="775" y="988" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">扣减库存消息(事务消息提交)</text><line x1="1075" y1="1021" x2="475" y2="1021" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#crosshead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="1075" y="1025" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">12</text><g><line x1="465" y1="764" x2="1163" y2="764" class="loopLine"></line><line x1="1163" y1="764" x2="1163" y2="1031" class="loopLine"></line><line x1="465" y1="1031" x2="1163" y2="1031" class="loopLine"></line><line x1="465" y1="764" x2="465" y2="1031" class="loopLine"></line><polygon points="465,764 515,764 515,777 506.6,784 465,784" class="labelBox"></polygon><text x="490" y="777" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">opt</text><text x="839" y="782" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="839">[创建订单]</tspan></text></g><text x="775" y="1091" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">库存处理结果</text><line x1="475" y1="1124" x2="1075" y2="1124" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="475" y="1128" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">13</text><text x="1075" y="1184" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">更新订单状态</text><path d="M 1075,1217 C 1135,1207 1135,1247 1075,1237" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></path><text x="1075" y="1221" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">14</text><text x="975" y="1262" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">下单成功</text><line x1="1075" y1="1295" x2="875" y2="1295" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="1075" y="1299" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">15</text><text x="975" y="1335" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">下单失败</text><line x1="1075" y1="1368" x2="875" y2="1368" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="1075" y="1372" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">16</text><g><line x1="865" y1="1134" x2="1160" y2="1134" class="loopLine"></line><line x1="1160" y1="1134" x2="1160" y2="1378" class="loopLine"></line><line x1="865" y1="1378" x2="1160" y2="1378" class="loopLine"></line><line x1="865" y1="1134" x2="865" y2="1378" class="loopLine"></line><line x1="865" y1="1310" x2="1160" y2="1310" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="865,1134 915,1134 915,1147 906.6,1154 865,1154" class="labelBox"></polygon><text x="890" y="1147" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">alt</text><text x="1037.5" y="1152" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="1037.5">[库存锁定成功]</tspan></text></g><g><line x1="465" y1="1041" x2="1170" y2="1041" class="loopLine"></line><line x1="1170" y1="1041" x2="1170" y2="1388" class="loopLine"></line><line x1="465" y1="1388" x2="1170" y2="1388" class="loopLine"></line><line x1="465" y1="1041" x2="465" y2="1388" class="loopLine"></line><polygon points="465,1041 515,1041 515,1054 506.6,1061 465,1061" class="labelBox"></polygon><text x="490" y="1054" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">opt</text><text x="842.5" y="1059" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="842.5">[库存处理结果通知]</tspan></text></g><g><line x1="455" y1="719" x2="1180" y2="719" class="loopLine"></line><line x1="1180" y1="719" x2="1180" y2="1398" class="loopLine"></line><line x1="455" y1="1398" x2="1180" y2="1398" class="loopLine"></line><line x1="455" y1="719" x2="455" y2="1398" class="loopLine"></line><polygon points="455,719 505,719 505,732 496.6,739 455,739" class="labelBox"></polygon><text x="480" y="732" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">opt</text><text x="842.5" y="737" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="842.5">[订单处理]</tspan></text></g><text x="897" y="1488" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">预扣减库存消息</text><line x1="475" y1="1521" x2="1319" y2="1521" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="475" y="1525" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">17</text><text x="1319" y="1536" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">库存校验及锁定(乐观锁)</text><path d="M 1319,1569 C 1379,1559 1379,1599 1319,1589" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></path><text x="1319" y="1573" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">18</text><text x="897" y="1614" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">库存操作结果消息</text><line x1="1319" y1="1647" x2="475" y2="1647" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#crosshead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="1319" y="1651" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">19</text><g><line x1="465" y1="1438" x2="1415" y2="1438" class="loopLine"></line><line x1="1415" y1="1438" x2="1415" y2="1657" class="loopLine"></line><line x1="465" y1="1657" x2="1415" y2="1657" class="loopLine"></line><line x1="465" y1="1438" x2="465" y2="1657" class="loopLine"></line><polygon points="465,1438 515,1438 515,1451 506.6,1458 465,1458" class="labelBox"></polygon><text x="490" y="1451" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">opt</text><text x="965" y="1456" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="965">[库存处理]</tspan></text></g><text x="375" y="1747" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">是否下单成功</text><line x1="75" y1="1780" x2="675" y2="1780" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="75" y="1784" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">20</text><text x="775" y="1795" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">获取下单结果</text><line x1="675" y1="1828" x2="875" y2="1828" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="675" y="1832" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">21</text><text x="775" y="1843" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">return</text><line x1="875" y1="1876" x2="675" y2="1876" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="875" y="1880" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">22</text><text x="375" y="1936" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">下单成功</text><line x1="675" y1="1969" x2="75" y2="1969" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="675" y="1973" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">23</text><text x="375" y="2029" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">结束</text><line x1="675" y1="2062" x2="75" y2="2062" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="675" y="2066" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">24</text><text x="375" y="2122" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">稍后继续来查看</text><line x1="675" y1="2155" x2="75" y2="2155" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="675" y="2159" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">25</text><g><line x1="65" y1="1886" x2="685" y2="1886" class="loopLine"></line><line x1="685" y1="1886" x2="685" y2="2165" class="loopLine"></line><line x1="65" y1="2165" x2="685" y2="2165" class="loopLine"></line><line x1="65" y1="1886" x2="65" y2="2165" class="loopLine"></line><line x1="65" y1="1984" x2="685" y2="1984" class="loopLine" style="stroke-dasharray: 3, 3;"></line><line x1="65" y1="2077" x2="685" y2="2077" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="65,1886 115,1886 115,1899 106.6,1906 65,1906" class="labelBox"></polygon><text x="90" y="1899" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">alt</text><text x="400" y="1904" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="400">[下单成功]</tspan></text><text x="375" y="2002" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">[下单失败]</text><text x="375" y="2095" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">[未完成]</text></g><g><line x1="55" y1="1697" x2="885" y2="1697" class="loopLine"></line><line x1="885" y1="1697" x2="885" y2="2175" class="loopLine"></line><line x1="55" y1="2175" x2="885" y2="2175" class="loopLine"></line><line x1="55" y1="1697" x2="55" y2="2175" class="loopLine"></line><polygon points="55,1697 105,1697 105,1710 96.6,1717 55,1717" class="labelBox"></polygon><text x="80" y="1710" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">opt</text><text x="495" y="1715" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="495">[用户下单结果探测]</tspan></text></g><g><rect x="50" y="2195" fill="#EDF2AE" stroke="#666" width="1294" height="36" rx="0" ry="0" class="note"></rect><text x="697" y="2200" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="noteText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 14px; font-weight: 400;"><tspan x="697">用户下单结果探测使用短轮询，轮询间隔随机,避免集中轮询</tspan></text></g><g><rect x="0" y="2251" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="2283.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="75" dy="0">用户</tspan></text></g><g><rect x="200" y="2251" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="2283.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="275" dy="0">限流器</tspan></text></g><g><rect x="400" y="2251" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="2283.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="475" dy="0">队列(MQ)</tspan></text></g><g><rect x="600" y="2251" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="675" y="2283.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="675" dy="0">秒杀IC</tspan></text></g><g><rect x="800" y="2251" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="875" y="2283.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="875" dy="0">缓存</tspan></text></g><g><rect x="1000" y="2251" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1075" y="2283.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="1075" dy="0">订单系统</tspan></text></g><g><rect x="1244" y="2251" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1319" y="2283.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="1319" dy="0">库存系统</tspan></text></g></svg>